(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[839],{451:(e,l,r)=>{"use strict";r.d(l,{A:()=>a});var s=r(4248),n=r(9661);function a(e){let{role:l,children:r}=e,{userId:a,profile:i,loading:t}=(0,n.A)();return t?(0,s.jsx)("div",{className:"card p-6",children:"Cargando…"}):a?i?"passenger"===l&&"passenger"!==i.role?(0,s.jsx)("div",{className:"card p-6",children:"Solo para pasajeros."}):"driver"===l&&"driver"!==i.role?(0,s.jsx)("div",{className:"card p-6",children:"Solo para conductores."}):"admin"===l&&"admin"!==i.role?(0,s.jsx)("div",{className:"card p-6",children:"Solo admins."}):(0,s.jsx)(s.Fragment,{children:r}):(0,s.jsx)("div",{className:"card p-6",children:"Perfil no encontrado."}):(0,s.jsx)("div",{className:"card p-6",children:"Inicia sesi\xf3n."})}},2948:(e,l,r)=>{Promise.resolve().then(r.bind(r,5631))},5631:(e,l,r)=>{"use strict";r.r(l),r.d(l,{default:()=>u});var s=r(4248),n=r(7642),a=r.n(n),i=r(451),t=r(9661);function u(){let{profile:e}=(0,t.A)();return(0,s.jsx)(i.A,{role:"driver",children:(0,s.jsxs)("div",{className:"max-w-xl mx-auto card p-6 space-y-4",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold",children:["Conductor — ",null==e?void 0:e.full_name]}),(0,s.jsx)(a(),{className:"btn w-full",href:"/driver/session",children:"Ir a Jornada"})]})})}},9410:(e,l,r)=>{"use strict";r.d(l,{N:()=>s});let s=(0,r(5835).createBrowserClient)("https://exyxexamvwfvwxjjfqpl.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV4eXhleGFtdndmdnd4ampmcXBsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkyNDc5MzEsImV4cCI6MjA3NDgyMzkzMX0.JW0haLRNKznqB0C5zMx9wF7_u6RTZQsD6WwgqpHHVIU")},9661:(e,l,r)=>{"use strict";r.d(l,{A:()=>u,AuthProvider:()=>t});var s=r(4248),n=r(4564),a=r(9410);let i=(0,n.createContext)(null);function t(e){let{children:l}=e,[r,t]=(0,n.useState)(null),[u,d]=(0,n.useState)(null),[c,o]=(0,n.useState)(null),[m,p]=(0,n.useState)(!0),h=async(e,l)=>{let{data:r}=await a.N.from("profiles").select("*").eq("id",e).maybeSingle();if(r)return void o(r);let{data:s,error:n}=await a.N.rpc("ensure_profile",{p_id:e,p_email:null!=l?l:""});if(n){console.error("[ensure_profile rpc] error",n),o(null);return}o(null!=s?s:null)};(0,n.useEffect)(()=>{(async()=>{var e,l,r,s,n,i;let{data:u}=await a.N.auth.getSession(),c=null!=(n=null==(l=u.session)||null==(e=l.user)?void 0:e.id)?n:null,o=null!=(i=null==(s=u.session)||null==(r=s.user)?void 0:r.email)?i:null;t(c),d(o),c&&await h(c,o),p(!1)})();let{data:e}=a.N.auth.onAuthStateChange(async(e,l)=>{var r,s,n,a;let i=null!=(n=null==l||null==(r=l.user)?void 0:r.id)?n:null,u=null!=(a=null==l||null==(s=l.user)?void 0:s.email)?a:null;t(i),d(u),i?await h(i,u):o(null)});return()=>{e.subscription.unsubscribe()}},[]);let v=async()=>{await a.N.auth.signOut()};return(0,s.jsx)(i.Provider,{value:{userId:r,email:u,profile:c,loading:m,signOut:v},children:l})}let u=()=>{let e=(0,n.useContext)(i);if(!e)throw Error("AuthProvider missing");return e}}},e=>{e.O(0,[835,642,647,516,358],()=>e(e.s=2948)),_N_E=e.O()}]);