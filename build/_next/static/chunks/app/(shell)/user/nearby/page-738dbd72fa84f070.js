(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[584],{451:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var l=r(4248),a=r(9661),s=r(5519);function n(e){let{role:t,children:r}=e,{loading:n,userId:i,profile:u}=(0,a.A)(),c=(0,s.useRouter)();return n?(0,l.jsx)("div",{className:"p-6 text-sm text-gray-500",children:"Cargandoâ€¦"}):i?(null==u?void 0:u.role)!==t?(0,l.jsx)("div",{className:"p-6",children:"Acceso denegado"}):(0,l.jsx)(l.Fragment,{children:r}):(c.push("/login"),null)}},5519:(e,t,r)=>{"use strict";var l=r(2455);r.o(l,"usePathname")&&r.d(t,{usePathname:function(){return l.usePathname}}),r.o(l,"useRouter")&&r.d(t,{useRouter:function(){return l.useRouter}})},6037:(e,t,r)=>{Promise.resolve().then(r.bind(r,8087))},8087:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var l=r(4248),a=r(451),s=r(4564);let n=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var u={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:l=24,strokeWidth:a=2,absoluteStrokeWidth:n,className:c="",children:o,iconNode:d,...h}=e;return(0,s.createElement)("svg",{ref:t,...u,width:l,height:l,stroke:r,strokeWidth:n?24*Number(a)/Number(l):a,className:i("lucide",c),...!o&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(h)&&{"aria-hidden":"true"},...h},[...d.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(o)?o:[o]])}),o=((e,t)=>{let r=(0,s.forwardRef)((r,l)=>{let{className:a,...u}=r;return(0,s.createElement)(c,{ref:l,iconNode:t,className:i("lucide-".concat(n(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),a),...u})});return r.displayName=n(e),r})("bus",[["path",{d:"M8 6v6",key:"18i7km"}],["path",{d:"M15 6v6",key:"1sg6z9"}],["path",{d:"M2 12h19.6",key:"de5uta"}],["path",{d:"M18 18h3s.5-1.7.8-2.8c.1-.4.2-.8.2-1.2 0-.4-.1-.8-.2-1.2l-1.4-5C20.1 6.8 19.1 6 18 6H4a2 2 0 0 0-2 2v10h3",key:"1wwztk"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M9 18h5",key:"lrx6i"}],["circle",{cx:"16",cy:"18",r:"2",key:"1v4tcr"}]]);function d(){return(0,l.jsx)(a.A,{role:"passenger",children:(0,l.jsxs)("div",{className:"card p-6 space-y-3",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold",children:"Unidades cercanas"}),(0,l.jsxs)("div",{className:"relative w-full h-72 rounded-2xl border bg-gray-100 dark:bg-gray-900 overflow-hidden",children:[(0,l.jsxs)("div",{className:"absolute -translate-x-1/2 -translate-y-1/2",style:{left:"".concat(50,"%"),top:"".concat(50,"%")},children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full bg-payki-600 border-2 border-white shadow"}),(0,l.jsx)("div",{className:"text-[10px] mt-1 text-gray-600",children:"T\xfa"})]}),[{id:"B-102",x:30,y:40},{id:"B-205",x:55,y:20},{id:"B-311",x:70,y:65}].map(e=>(0,l.jsxs)("div",{className:"absolute -translate-x-1/2 -translate-y-1/2",style:{left:"".concat(e.x,"%"),top:"".concat(e.y,"%")},children:[(0,l.jsx)(o,{className:"w-5 h-5"}),(0,l.jsx)("div",{className:"text-[10px] mt-1 text-gray-600",children:e.id})]},e.id))]})]})})}},9410:(e,t,r)=>{"use strict";r.d(t,{N:()=>l});let l=(0,r(5835).createBrowserClient)("https://exyxexamvwfvwxjjfqpl.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV4eXhleGFtdndmdnd4ampmcXBsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkyNDc5MzEsImV4cCI6MjA3NDgyMzkzMX0.JW0haLRNKznqB0C5zMx9wF7_u6RTZQsD6WwgqpHHVIU")},9661:(e,t,r)=>{"use strict";r.d(t,{A:()=>u,O:()=>i});var l=r(4248),a=r(4564),s=r(9410);let n=(0,a.createContext)(null);function i(e){let{children:t}=e,[r,i]=(0,a.useState)(null),[u,c]=(0,a.useState)(null),[o,d]=(0,a.useState)(null),[h,m]=(0,a.useState)(!0),p=async(e,t)=>{try{let{data:r}=await s.N.from("profiles").select("*").eq("id",e).maybeSingle();if(r)return void d(r);let{data:l,error:a}=await s.N.rpc("ensure_profile",{p_id:e,p_email:null!=t?t:""});if(a){console.error("[ensure_profile] error",a),d(null);return}d(l)}catch(e){console.error("[fetchOrCreate] ",e),d(null)}};(0,a.useEffect)(()=>{let e=!0;(async()=>{var t,r,l,a;let{data:{session:n}}=await s.N.auth.getSession(),u=null!=(l=null==n||null==(t=n.user)?void 0:t.id)?l:null,o=null!=(a=null==n||null==(r=n.user)?void 0:r.email)?a:null;e&&(i(u),c(o),u&&await p(u,o),e&&m(!1))})();let{data:t}=s.N.auth.onAuthStateChange(async(e,t)=>{var r,l,a,s;let n=null!=(a=null==t||null==(r=t.user)?void 0:r.id)?a:null,u=null!=(s=null==t||null==(l=t.user)?void 0:l.email)?s:null;i(n),c(u),n?await p(n,u):d(null)});return()=>{e=!1,t.subscription.unsubscribe()}},[]);let x=async()=>{await s.N.auth.signOut()};return(0,l.jsx)(n.Provider,{value:{userId:r,email:u,profile:o,loading:h,signOut:x},children:t})}let u=()=>{let e=(0,a.useContext)(n);if(!e)throw Error("AuthProvider missing");return e}}},e=>{e.O(0,[835,647,516,358],()=>e(e.s=6037)),_N_E=e.O()}]);